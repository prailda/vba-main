---
id: B7ED-B016-175E-42C1-BFAF-B246-A60C-21EC
name: understanding-libraries
title: Understanding Libraries
description: -
domain: vba
solution: knowlages-solution
category:
  - docs
group:
  - articles
tags:
  - vba
  - knowlages-solution
  - rubberduck
  - articles
author:
  - Rubberduck
url: https://rubberduckvba.blog/2024/08/14/understanding-libraries/
created_at: 2025-11-19T08:43:13
---
# Understanding Libraries

## VBA as a Language

VBA is a single programming language, not multiple "flavors." The confusion stems from conflating the language with its libraries. VBA's language specifications define it through its type system, syntax, and semantics, all of which remain identical across host applications. Host-agnostic code runs identically in every conceivable host application.

What differs across hosts are the objects exposed through different libraries. These differences are limited to default references and the host application's object model. The objects used depend on what the code needs to accomplish.

## Library Functionality

Libraries are dynamic link libraries (DLLs) that define types and members, enabling other executables to dynamically link and invoke these methods. Libraries extend a program's vocabulary with nouns (types/classes) and verbs (methods), but this is merely colorful expression of the same underlying language.

COM libraries function as servers using interfaces that all COM clients understand. VBA references and uses such libraries because it is built on COM technology. Whenever a VBA project compiles, a COM library is generated in-memory within the host process. The running code executes this compiled library, not interpreted source code.

The VBA source code in the editor is decompiled from p-code tokens generated by compiling the original source. This is why the VBE appears to "autocorrect" when validating a line.

## Browsing Libraries

VBA implements the COM type system while hiding pointers and invocation mechanisms (IDispatch and IUnknown interfaces). Hidden attributes control type and member metadata, including documentation. The VBE's Object Browser reveals everything, including hidden members (which VBA honors differently than VB6 did). Enable "Show hidden members" in the right-click menu to display them in the browser and name completion lists. The dropdown in the search/filter section lists all loaded libraries, including the compiled VBA project itself.

## Global Namespace Pollution

Everything public in a library enters the global namespace once loaded. When two libraries define classes with identical names, the library priority order determines binding. The up/down arrows in the add/remove references dialog control this priority. The VBA standard library and host application's object model library remain at the top in that order. Other libraries can be reordered.

When VBA binds a Range declaration, an unqualified Range binds to Word.Range in Microsoft Word or Excel.Range in Microsoft Excel, even if both libraries are referenced, because the host application's library always has higher priority. Library priority significantly affects binding in Access projects referencing both DAO and ADO, where accidentally flipping priorities can rewrite Recordset references.

## Know Your Tools

The Object Browser provides essential orientation when encountering new libraries, whether a new host, Scripting, or regular expressions. Browsing types and members often provides sufficient direction for consulting documentation or other resources.

The VBA standard library provides a small set of basic functions and constants available to any VBA project. Host-agnostic modules can use these freely. This library is the closest approximation to a framework VBA provides. The functions are mostly wrappers around Win32 API calls, enabling message boxes, string and date manipulation, and basic math and trigonometry operations.

VBA developers must understand what the VBA standard library does and doesn't provide to avoid reinventing existing functionality. Though small compared to the .NET Framework, it provides bare-bones functionality suitable as a backbone for building upon.

The Excel library is much larger. Focus on Application, Workbook, Worksheet, Range, and Name classes and their members. Learn the rest from documentation and examples as needed. Hidden classes place Application members and active Workbook/Worksheet members into global scope "for convenience," which obscures code behavior. Code behavior often cannot be determined without additional context, such as whether code resides in a worksheet module or standard module. Good code does what it says and says what it does.

## Documentation Context

Technical documentation examples demonstrate specific features, not necessarily best practices for variable declaration or parameter passing. Macro recorder code works with implicit ActiveSheet references but shouldn't be emulated in production code. The macro recorder teaches which types and members are involved but not how to use them beyond active sheet and current selection context. Proper code should be explicit about these two elements.

Both the VBA standard library and Excel object model are extensively documented. However, the Excel library leverages COM/VBA features in ways that remain trapped in 1990s notions of convenience, with implicit behaviors that complicate debugging.
